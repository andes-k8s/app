<ng-container *ngIf="!soloValores && elementoRUP.requeridos && elementoRUP.requeridos.length">
    <div class="row align-items-center">
        <div class="col-6">
            <form #form="ngForm">
                <plex-select [(ngModel)]="registro.valor.unidadOrganizativa" name="servicio2" [data]="unidadesOrganizativas"
                    idField="conceptId" labelField="term" label="Unidad Organizativa" [required]="true"></plex-select>
            </form>
        </div>
        <div class="col mt-4">
            <plex-button label="{{ mensajeAccionAccordion }} Todos" type="primary btn-sm" (click)="desplegarAccordions()"></plex-button>
            <plex-button label="Árbol de relaciones" type="primary btn-sm" (click)="VerArbolRelaciones()"></plex-button>
        </div>
    </div>
    <plex-accordion>
        <ng-container *ngFor="let item of elementoRUP.requeridos; let i = index">
            <plex-panel [ngClass]="{'alerta-campo' : !cristinaVolve.isValid}" icon="arrow-down-drop-circle-outline"
                (click)="accordionSeleccionado(i)" [active]="accordionActive === i || desplegarTodo" class="hover">

                <div plex-accordion-title>
                    <span class="contenedor-icono">
                        <i class="icon {{ item.params.icon }}"></i>
                    </span>

                    <span class="titulo">
                        {{ item.concepto.term }}
                    </span>

                    <plex-button icon="mdi mdi-chevron-left" type="primary btn-sm float-right"></plex-button>

                    <span *ngIf="!cristinaVolve.isValid" class="badge badge-danger float-right mr-4">
                        Hay registros incompletos
                    </span>
                    <span *ngIf="!registro.registros[i].registros.length && i > 0 && cristinaVolve.isValid" class="badge badge-warning float-right mr-4">
                        No hay conceptos registrados
                    </span>
                    <span *ngIf="registro.registros[i].registros.length && cristinaVolve.isValid" class="badge badge-info float-right mr-4">
                        {{ registro.registros[i].registros.length }} Conceptos registrados
                    </span>
                </div>
                <rup [elementoRUP]="item.elementoRUP" [paciente]="paciente" [params]="item.params" [prestacion]="prestacion"
                    [registro]="registro.registros[i]" [soloValores]="soloValores" (change)="emitChange()"
                    #cristinaVolve>
                </rup>
            </plex-panel>
        </ng-container>
    </plex-accordion>
</ng-container>

<ng-container *ngIf="soloValores">
    <strong> Unidad Organizativa de la epicrisis: </strong> <br> {{ registro.valor.unidadOrganizativa.term }}
    <br>
    <hr>
    <ng-container *ngFor="let item of elementoRUP.requeridos; let i = index">
        <span class="titulo">
            <strong> {{ item.params.titulo }}</strong>
        </span>
        <plex-button icon="mdi mdi-chevron-left" type="primary btn-sm float-right"></plex-button>
        <rup [elementoRUP]="item.elementoRUP" [paciente]="paciente" [params]="item.params" [prestacion]="prestacion"
            [registro]="registro.registros[i]" [soloValores]="soloValores" (change)="emitChange()">
        </rup>
        <hr>
    </ng-container>
</ng-container>
