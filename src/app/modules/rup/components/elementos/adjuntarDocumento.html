<div *ngIf="fileToken" class="hr-inline-group">
    <section>
        <ng-container *ngIf="registro?.valor?.documentos?.length && fileToken">
            <div class="adjunto" *ngFor="let doc of registro.valor.documentos; let i = index">
                <div class="img-container hover" justify>
                    <!-- es imagen -->
                    <img class="miniatura" [src]="createUrl(doc)" (click)="viewer.open(i)" alt="{{ doc.ext }}"
                         *ngIf="esDeTipo(doc.ext, 'image')" />
                    <!-- es audio -->
                    <audio *ngIf="esDeTipo(doc.ext, 'audio')" [src]="createUrl(doc)" preload="auto" controls></audio>
                    <!-- es video -->
                    <video *ngIf="esDeTipo(doc.ext, 'video')" [src]="createUrl(doc)" preload="auto" controls></video>
                    <!-- es otro -->
                    <div *ngIf="esDeTipo(doc.ext, 'other')"
                         class="adjunto-otro d-flex align-items-center justify-content-center">
                        <a [href]="createUrl(doc)" target="_blank" class="m-1 p-2 font-weight-bold">
                            <span class="text-uppercase">{{ doc.ext }}</span>
                        </a>
                    </div>
                    <plex-button *ngIf="!soloValores" icon="delete" size="sm" type="danger w-100"
                                 (click)="confirmarEliminarImagen(doc)" title="Eliminar documento">
                    </plex-button>
                </div>
                <div (click)="lightbox = false" *ngIf="i === indice && lightbox"
                     [ngClass]="{'lightbox': i === indice && lightbox }">
                    <div class="d-flex img-container" [ngClass]="{'h-100 align-items-center': lightbox === true}">
                        <img [src]="viewer.open(i)" alt="" *ngIf="esDeTipo(doc.ext, 'image')">
                        <span class="term text-white text-capitalize px-2"
                              *ngIf="doc?.descripcion?.term">{{ doc.descripcion.term }}</span>
                        <span class="term text-white text-capitalize px-2" *ngIf="!doc?.descripcion?.term">Sin
                            descripción</span>
                    </div>
                    <a [href]="createUrl(doc)" target="_blank" *ngIf="esDeTipo(doc.ext, 'other')"
                       class="adjunto m-1 p-2 font-weight-bold">
                        Documento ({{ doc.ext }})
                    </a>
                    <!-- es audio -->
                    <audio *ngIf="esDeTipo(doc.ext, 'audio')" preload="auto" controls></audio>
                    <!-- es video -->
                    <video *ngIf="esDeTipo(doc.ext, 'video')" preload="auto" controls></video>
                </div>
                <div class="blend-overlay" *ngIf="soloValores">
                    <div class="info-container" *ngIf="soloValores">
                        <span class="fecha badge badge-info" *ngIf="doc?.fecha">{{ doc.fecha | fecha }}</span>
                        <span class="fecha badge badge-info" *ngIf="!doc?.fecha">Sin fecha</span>
                        <span class="term text-capitalize"
                              *ngIf="doc?.descripcion?.term">{{ doc.descripcion.term }}</span>
                        <span class="term text-capitalize" *ngIf="!doc?.descripcion?.term">Sin descripción</span>
                    </div>
                </div>
                <div class="form-container" *ngIf="!soloValores">
                    <span class="fecha" *ngIf="!soloValores">
                        <plex-datetime type="date" [(ngModel)]="doc.fecha" name="fecha{{i}}" [max]="hoy"
                                       placeholder="dd/mm/aaaa">
                        </plex-datetime>
                    </span>
                    <span class="term">
                        <plex-select *ngIf="!soloValores && descendientesInformeClinico.length"
                                     [(ngModel)]="doc.descripcion" name="select{{i}}" idField="term" labelField="term"
                                     [data]="descendientesInformeClinico" [required]="true"
                                     placeholder="Tipo de documento">
                        </plex-select>
                    </span>
                </div>
                <plex-visualizador #viewer [files]="adjuntos" (click)="viewer.close()">
                </plex-visualizador>
            </div>
        </ng-container>
        <div class="row" *ngIf="!soloValores">
            <div class="col-12">
                <div class="hr-inline-group h-100" *ngIf="fileToken">
                    <plex-dropdown type="info" icon="plus" class="agregar dropdown-inline" [right]="false"
                                   [items]="items">
                        <div class="agregar-documento" justify>
                            Adjuntar Documento
                        </div>
                    </plex-dropdown>
                    <div class="agregar-overlay"></div>
                    <span *ngIf="waiting">
                        <plex-loader class="app-waiting" type="ball-pulse-sync"></plex-loader>
                        <plex-button type="danger" class="btn-sm" label="Cancelar" (click)="cancelar()"></plex-button>
                    </span>
                </div>
            </div>
        </div>
    </section>
</div>
<input type="file" (change)="changeListener($event)" #upload #uploaded>