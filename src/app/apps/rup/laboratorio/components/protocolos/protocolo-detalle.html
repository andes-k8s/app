<div class="paciente-seleccionado edicion" *ngIf="contextoCache.edicionDatosCabecera">
    <span *ngIf="solicitudProtocolo.solicitudPrestacion.numeroProtocolo" class="badge badge-success">
        <h2>{{ solicitudProtocolo.solicitudPrestacion.numeroProtocolo?.numeroCompleto }}</h2>
    </span>
    <img *ngIf="modelo.paciente.foto" src="{{ modelo.paciente.foto }}" alt="">
    <img *ngIf="!modelo.paciente.foto" src='data:image/svg+xml;charset=utf-8,<svg%20version%3D"1.1"%20id%3D"Layer_4"%20xmlns%3D"http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg"%20xmlns%3Axlink%3D"http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink"%20x%3D"0px"%20y%3D"0px"%0D%0A%09%20width%3D"480px"%20height%3D"535px"%20viewBox%3D"0%200%20480%20535"%20enable-background%3D"new%200%200%20480%20535"%20xml%3Aspace%3D"preserve">%0D%0A<g%20id%3D"Layer_3">%0D%0A%09<linearGradient%20id%3D"SVGID_1_"%20gradientUnits%3D"userSpaceOnUse"%20x1%3D"240"%20y1%3D"535"%20x2%3D"240"%20y2%3D"4.882812e-04">%0D%0A%09%09<stop%20%20offset%3D"0"%20style%3D"stop-color%3A%23C5C5C5"%2F>%0D%0A%09%09<stop%20%20offset%3D"1"%20style%3D"stop-color%3A%239A9A9A"%2F>%0D%0A%09<%2FlinearGradient>%0D%0A%09<rect%20fill%3D"url%28%23SVGID_1_%29"%20width%3D"480"%20height%3D"535"%2F>%0D%0A<%2Fg>%0D%0A<g%20id%3D"Layer_2">%0D%0A%09<path%20fill%3D"%23FFFFFF"%20d%3D"M347.5%2C250c0%2C59.375-48.125%2C107.5-107.5%2C107.5c-59.375%2C0-107.5-48.125-107.5-107.5%0D%0A%09%09c0-59.375%2C48.125-107.5%2C107.5-107.5C299.375%2C142.5%2C347.5%2C190.625%2C347.5%2C250z"%2F>%0D%0A%09<path%20fill%3D"%23FFFFFF"%20d%3D"M421.194%2C535C413.917%2C424.125%2C335.575%2C336.834%2C240%2C336.834c-95.576%2C0-173.917%2C87.291-181.194%2C198.166%0D%0A%09%09H421.194z"%2F>%0D%0A<%2Fg>%0D%0A<%2Fsvg>'>
    <div class="bg-inverse text-white">
        <span>
            {{ modelo.paciente | paciente }}
            <plex-button class="d-flex flex-row-reverse" position="right" type="warning" (click)="cambiarPaciente()"
                label="Cambiar Paciente"></plex-button>
        </span>
        <span>{{ modelo.paciente?.documento ? 'Documento: ' + modelo.paciente.documento : 'Sin documento'
            }}</span>
        <span *ngIf="modelo.paciente.fechaNacimiento === null">
            Fecha de nacimiento no registrada
        </span>
        <span *ngIf="modelo.paciente.fechaNacimiento !== null">
            Fecha de nacimiento: {{ modelo.paciente.fechaNacimiento | fecha }}
        </span>
        <span *ngIf="modelo.paciente.fechaNacimiento !== null">
            Sexo: {{ modelo.paciente | sexo }}
        </span>
    </div>
</div>
<div>
    <span *ngIf="contextoCache.edicionDatosCabecera && seleccionPaciente">
        <label for="paciente-buscar" class="form-control-label">Cambiar paciente</label>
        <paciente-buscar (searchStart)="searchStart()" (searchEnd)="searchEnd($event)" (searchClear)="searchStart()"></paciente-buscar>
        <!-- Tabla / listado de pacientes -->
        <ng-container *ngIf="!seleccion?.id && listado && listado.length">
            <div class="table-grid table-grid-head paciente">
                <span></span>
                <span>Apellidos y Nombres</span>
                <span>Documento</span>
                <span>F. Nacimiento</span>
                <span>Sexo</span>
            </div>
            <ng-container *ngFor="let paciente of listado">
                <div *ngIf="!seleccion?.id" class="table-grid paciente hover" (click)="onPacienteSelected(paciente)">
                    <img *ngIf="paciente.foto" class="img-thumbnail" class="w-50" src="{{ paciente.foto }}">
                    <img *ngIf="!paciente.foto" class="img-thumbnail" class="w-50" src='data:image/svg+xml;charset=utf-8,<svg%20version%3D"1.1"%20id%3D"Layer_4"%20xmlns%3D"http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg"%20xmlns%3Axlink%3D"http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink"%20x%3D"0px"%20y%3D"0px"%0D%0A%09%20width%3D"480px"%20height%3D"535px"%20viewBox%3D"0%200%20480%20535"%20enable-background%3D"new%200%200%20480%20535"%20xml%3Aspace%3D"preserve">%0D%0A<g%20id%3D"Layer_3">%0D%0A%09<linearGradient%20id%3D"SVGID_1_"%20gradientUnits%3D"userSpaceOnUse"%20x1%3D"240"%20y1%3D"535"%20x2%3D"240"%20y2%3D"4.882812e-04">%0D%0A%09%09<stop%20%20offset%3D"0"%20style%3D"stop-color%3A%23C5C5C5"%2F>%0D%0A%09%09<stop%20%20offset%3D"1"%20style%3D"stop-color%3A%239A9A9A"%2F>%0D%0A%09<%2FlinearGradient>%0D%0A%09<rect%20fill%3D"url%28%23SVGID_1_%29"%20width%3D"480"%20height%3D"535"%2F>%0D%0A<%2Fg>%0D%0A<g%20id%3D"Layer_2">%0D%0A%09<path%20fill%3D"%23FFFFFF"%20d%3D"M347.5%2C250c0%2C59.375-48.125%2C107.5-107.5%2C107.5c-59.375%2C0-107.5-48.125-107.5-107.5%0D%0A%09%09c0-59.375%2C48.125-107.5%2C107.5-107.5C299.375%2C142.5%2C347.5%2C190.625%2C347.5%2C250z"%2F>%0D%0A%09<path%20fill%3D"%23FFFFFF"%20d%3D"M421.194%2C535C413.917%2C424.125%2C335.575%2C336.834%2C240%2C336.834c-95.576%2C0-173.917%2C87.291-181.194%2C198.166%0D%0A%09%09H421.194z"%2F>%0D%0A<%2Fg>%0D%0A<%2Fsvg>'>
                    <span>{{ paciente | paciente }}</span>
                    <span>{{ paciente?.documento ? paciente.documento : 'Sin documento' }}</span>
                    <span *ngIf="paciente.fechaNacimiento === null">
                        No registrada
                    </span>
                    <span *ngIf="paciente.fechaNacimiento !== null">
                        {{ paciente.fechaNacimiento | fecha }}
                    </span>
                    <span *ngIf="paciente.fechaNacimiento !== null">
                        {{ paciente | sexo }}
                    </span>
                </div>
            </ng-container>
        </ng-container>
        <!-- <label>Cambiar paciente</label>
                <pacientesSearch [bloquearCreate]="true" [modoCompleto]="false" [hideFooter]="true" (selected)="seleccionarPaciente($event)">
                </pacientesSearch> -->
    </span>
</div>


<!--FIN SECCION PACIENTE-->

<!-- SECCION PROTOCOLO -->
<ng-container *ngIf="mostrarEncabezadoProtocolo()">
    <!-- ENCABEZADO DE PROTOCOLO -->
    <protocolo-encabezado [protocolo]="modelo" (edicionDatosCabeceraEmitter)="editarDatosCabecera()"
        (siguienteEmit)='siguiente()' (anteriorEmit)='anterior()' ></protocolo-encabezado>
    <!-- FIN ENCABEZADO DE PROTOCOLO -->
</ng-container>
<ng-container *ngIf='contextoCache.mostrarCuerpoProtocolo'>
    <plex-tabs>
        <plex-tab label="Análisis">

            <div class="row">
                <div class="col">
                    <tabla-datalle-protocolo [modo]="contextoCache.modo" [modelo]="modelo" [solicitudProtocolo]="solicitudProtocolo"
                        [practicasEjecucion]="practicasEjecucion" [busqueda]="busqueda" [editarListaPracticas]="editarListaPracticas"
                        [validaciones]="validaciones" [showGestorAlarmas]='showGestorAlarmas' [protocolos]='protocolos'
                        (verHistorialResultadosEmitter)='showHistorialResultados($event)'>
                    </tabla-datalle-protocolo>
                </div>
            </div>

        </plex-tab>
        <plex-tab *ngIf='modo.nombre === "recepcion" || modo.nombre === "control"' label="Diagnóstico">
            <div class="row">
                <div class="col-12">
                    <plex-text [(ngModel)]="solicitudProtocolo.solicitudPrestacion.diagnostico" label="Diagnóstico"
                        name="diagnostico" multiline="true"></plex-text>
                </div>
            </div>
        </plex-tab>
        <plex-tab label="Incidencias"></plex-tab>
    </plex-tabs>
    <!--OBSERVACIONES - RECEPCION-->
    <div class="row">
        <div *ngIf="modo.nombre === 'recepcionSinTurno' || modo.nombre === 'recepcion' || modo.nombre === 'control' || modo.nombre === 'carga'" class="col-12">
            <plex-text [(ngModel)]="solicitudProtocolo.solicitudPrestacion.observaciones" label="Observaciones internas"
                name="observaciones" multiline="true">
            </plex-text>
        </div>
        <div *ngIf="modo.nombre === 'validacion'" class="col-12">
            <b> {{solicitudProtocolo.solicitudPrestacion.observaciones}} </b>
        </div>
    </div>
</ng-container>

<chart-resultados-anteriores *ngIf='contextoCache.verHistorialResultados' [practica]='historialResultados'></chart-resultados-anteriores>
<!--FIN SECCION PRTOCOLO -->
