<section class="labs-listado-item" style="width: 100% !important">
    <div class="row">
        <div class="col-1 centradoVerticalBtn" *ngIf='modo !=="recepcion" && !edicionDatosCabecera'>
            <plex-button class="marginRightBtn" type="info" icon="chevron-left" (click)='anterior()'></plex-button>
        </div>
        <div class="col" [ngClass]="{'centradoVerticalBtn': !edicionDatosCabecera}">
            <div class="listado-contenedor-secundario">
                <!-- Modo visualizacion de datos -->
                <article *ngIf='!edicionDatosCabecera' class="labs-item-numero">
                    <span *ngIf='solicitudProtocolo.solicitudPrestacion.numeroProtocolo' class="badge badge-success"
                        style='float: left; margin-right: 20px;'>
                        <h5>
                            <i *ngIf='modelo.paciente.sexo ==="femenino"' class="mdi mdi-gender-female mdi-24px mdi-rotate-45 rosa"></i>
                            <i *ngIf='modelo.paciente.sexo ==="masculino"' class="mdi mdi-gender-male mdi-24px azul"></i>
                            {{solicitudProtocolo.solicitudPrestacion.numeroProtocolo.numeroCompleto}}
                        </h5>
                    </span>

                    <div class="row">
                        <div class="col">
                            <strong>Paciente: </strong>
                            {{modelo.paciente.documento}} - {{modelo.paciente.apellido}}, {{modelo.paciente.nombre}} F.
                            Nac.: {{modelo.paciente.fechaNacimiento
                            | date: 'dd/MM/yyyy' }}, Sexo: {{modelo.paciente.sexo}}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-4">
                            <strong>F. de solicitud: </strong>
                            {{ modelo.solicitud.fecha | date: 'dd/MM/yyyy' }}
                        </div>
                        <div class="col-4">
                            <strong>F. de Ejecucion:&nbsp;</strong>
                            {{ modelo.ejecucion.fecha | date: 'dd/MM/yyyy' }}
                        </div>
                        <div class="col-4">
                            <strong>Origen: </strong>
                            {{ modelo.solicitud.ambitoOrigen}}
                        </div>
                    </div>
                    <div class="row" *ngIf="mostrarMasOpciones">
                        <div class="col-2">
                            <strong>Servicio: </strong>
                            <p>{{solicitudProtocolo?.solicitudPrestacion?.servicio.term}}</p>
                        </div>
                        <div class="col-3">
                            <strong>Usuario:&nbsp;</strong>
                            <p>{{ modelo.createdBy?.nombreCompleto }}</p>
                        </div>
                        <div class="col-3">
                            <strong>Solicitante: </strong>
                            <p>{{ modelo.solicitud.profesional.nombre }} {{ modelo.solicitud.profesional.apellido }}</p>
                        </div>
                        <div class="col-7">
                            <strong>Efector Solicitante: </strong>
                            <p>{{ modelo.solicitud.organizacion.nombre }}</p>
                        </div>
                        <div class="col-12">
                            <strong>Diagnostico: </strong>
                            <p>{{ modelo.solicitud.registros[0]?.valor?.solicitudPrestacion.diagnostico }}</p>
                        </div>
                    </div>
                </article>
                <!-- Modo edicion de datos -->
                <article *ngIf='edicionDatosCabecera && !seleccionPaciente' class="labs-item-numero">
                    <div class="row ml-1" style="width: 100% !important;">
                        <div class="col-2">
                            <plex-datetime type="date" [(ngModel)]="modelo.ejecucion.fecha" name="fecha" label="Fecha"
                                [required]="true"></plex-datetime>
                        </div>
                        <div class="col-2">
                            <plex-datetime type="date" [(ngModel)]="solicitudProtocolo.solicitudPrestacion.fechaTomaMuestra"
                                name="fechaTomaMuestra" label="F. Muestra" [required]="true"></plex-datetime>
                        </div>
                        <div class="col-2">
                            <plex-datetime type="date" [(ngModel)]="modelo.solicitud.fecha" name="fecha" label="F. solicitud"
                                [required]="true"></plex-datetime>
                        </div>
                    </div>
                    <div class="row ml-1">
                        <div class="col-5">
                            <!-- TODO: Una vez implementado TOP cambiar modelo.solicitud.organizacion x modelo.solicitud.organizacionOrigen -->
                            <plex-select [(ngModel)]="modelo.solicitud.organizacion" [data]="organizacion" labelField="nombre" (getData)="loadOrganizacion($event)"
                                placeholder="Seleccione..." label="Efector Solicitante" [required]="true">
                            </plex-select>
                        </div>
                        <div class="col-6">
                            <!-- TODO: Una vez implementado TOP cambiar modelo.solicitud.profesional x modelo.solicitud.profesionalOrigen -->
                            <plex-select [(ngModel)]="modelo.solicitud.profesional" name="profesional" label="Profesional solicitante"
                                (getData)="loadProfesionales($event)" placeholder="Escriba el apellido del Profesional"
                                labelField="apellido + ' ' + nombre" [required]="true">
                            </plex-select>
                        </div>
                    </div>
                    <div class="row ml-1">
                        <div class="col-3">
                            <plex-select [(ngModel)]="modelo.solicitud.ambitoOrigen" name="ambitoOrigen" (getData)="loadOrigen($event)"
                                label="Origen" placeholder="Seleccione el origen" [required]="true">
                            </plex-select>
                        </div>
                        <div class="col-4">
                            <plex-select [(ngModel)]="solicitudProtocolo.solicitudPrestacion.servicio" label="Servicio"
                                placeholder="Seleccione el servicio" (getData)="loadServicios($event)" labelField='term'>
                            </plex-select>
                        </div>
                        <div class="col-2">
                            <plex-select [(ngModel)]="solicitudProtocolo.solicitudPrestacion.prioridad" name="prioridad"
                                (getData)="loadPrioridad($event)" label="Prioridad" placeholder="Seleccione la prioridad"
                                labelField="nombre" [required]="true">
                            </plex-select>
                        </div>
                    </div>
                </article>
            </div>
        </div>
        <div class="col-1 centradoVerticalBtn" *ngIf='modo === "control" && !edicionDatosCabecera'>
            <plex-button icon="mdi mdi-pencil" class="float-right mr-2 marginLeftBtn" (click)="editarDatosCabecera()"
                title="Editar datos">
            </plex-button>
        </div>
        <div class="col-1 centradoVerticalBtn" *ngIf='modo !== "recepcion" && !edicionDatosCabecera'>
            <plex-button label="" type="info" [icon]="mostrarMasOpciones ? 'chevron-up' : 'chevron-down'" (click)="mostrarMasOpciones = !mostrarMasOpciones"></plex-button>
        </div>
        <div class="col-1 centradoVerticalBtn" *ngIf='modo !== "recepcion" && !edicionDatosCabecera'>
            <plex-button type="info" class='float-right mr-2' icon='chevron-right' (click)='siguiente()' style='margin-left: 10px;'></plex-button>
        </div>
    </div>
</section>
